<h1>Tasks#show</h1>
<h2>Title: <%= @task.title %></h2>
<p>Description: <%= @task.description %></p>

<h3>Assigned Users:</h3>
<%= turbo_frame_tag "task_users" do %>
  <ul>
    <% @task.user_tasks.each do |user_task| %>
      <li id="user_task_<%= user_task.id %>">
        <%= image_tag(user_task.user.avatar, alt: "#{user_task.user.first_name}'s avatar", class: "avatar-bordered") if user_task.user.avatar.attached? %>
        <%= user_task.user.first_name %> <%= user_task.user.last_name %>
        <%= button_to 'Remove', remove_user_from_task_task_path(task_id: @task.id, user_id: user_task.user.id), method: :delete, data: { turbo_confirm: 'Are you sure?' }, class: "btn btn-danger" %>
      </li>
    <% end %>
  </ul>
<% end %>

<%= form_with url: add_user_task_path(@task), method: :post do |form| %>
  <%= select_tag :user_id, options_from_collection_for_select(User.all, :id, :first_name) %>
  <%= form.submit "Add User" %>
<% end %>

<p> Deadline: <%= @task.deadline %></p>

<h3>Comments:</h3>
<%= turbo_frame_tag "comments" do %>
  <% @task.task_comments.each do |comment| %>
    <%= render "comments/comment", comment: comment %>
  <% end %>
<% end %>


<h3>Add a Comment:</h3>
<%= turbo_frame_tag "new_comment" do %>
  <%= form_with model: [ @task, TaskComment.new ], url: task_comments_path(@task), id: "new_comment_form" do |form| %>
    <div>
      <%= form.label :content, 'Your Comment:' %>
      <%= form.text_area :content %>
    </div>
    <div>
      <%= form.submit 'Submit Comment' %>
    </div>
  <% end %>
<% end %>



<%= form_with model: @task, url: toggle_completion_task_path(@task), method: :patch, id: "task_completion_form_#{@task.id}", data: { turbo_frame: "task_#{@task.id}" } do |form| %>
  <div class="form-check form-switch">
    <%= form.check_box :completed, class: "form-check-input", id: "completedSwitch#{@task.id}", onchange: "this.form.submit();" %>
    <%= form.label :completed, 'Completed:', class: "form-check-label", for: "completedSwitch#{@task.id}" %>
  </div>
<% end %>

<%= link_to 'Back to Tasks', tasks_path %>
